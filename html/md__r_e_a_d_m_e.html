<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ARM-SchiffeVersenken: Arm Cortex-M0 Base Project</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ARM-SchiffeVersenken
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Arm Cortex-M0 Base Project</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md0"></a> Example Workspace für die Vorlesung Systemnahe Programmierung II an der DHWB Ravensburg.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Arm Documentation</h1>
<ul>
<li><a href="https://developer.arm.com/Processors/Cortex-M0">Cortex M0 Startseite</a><ul>
<li><a href="https://developer.arm.com/documentation/ddi0419/latest/">Armv6-M Architecture Reference Manual</a></li>
<li><a href="https://developer.arm.com/documentation/102834/0100/?lang=en">Arm Cortex-M0 Processor Datasheet</a></li>
<li><a href="https://developer.arm.com/documentation/dui0497/a/?lang=en">Cortex-M0 Devices Generic User Guide</a></li>
<li><a href="https://developer.arm.com/documentation/ddi0432/c/?lang=en">Cortex-M0 Technical Reference Manual r0p0</a></li>
</ul>
</li>
<li><a href="https://github.com/ARM-software/abi-aa">Arm Application Binary Interface</a></li>
<li><a href="https://sourceware.org/binutils/docs-2.40/as/index.html">GNU Assembler Documentation</a></li>
<li><a href="https://sourceware.org/binutils/docs-2.40/ld/index.html">GNU Linker Documentation</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md2"></a>
Simuliertes Board Info</h1>
<ul>
<li><a href="https://www.qemu.org/docs/master/system/arm/nrf.html">Nordic nRF boards (microbit)</a></li>
<li><a href="https://www.nordicsemi.com/products/nrf51822">Nordic nRF51822</a></li>
<li><a href="https://infocenter.nordicsemi.com/pdf/nRF51822_PS_v3.4.pdf">nRF51822 Product Specification v3.4</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md3"></a>
Prerequisites</h1>
<ul>
<li>Arm Cross Compiler Paket: <em>gcc-arm-none-eabi</em></li>
<li>QEMU Arm Paket: <em>qemu-system-arm</em></li>
<li>GDB (Multi-Arch) Paket: <em>gdb-multiarch</em></li>
<li>CMake</li>
</ul>
<p>Hinweis: Bei SUSE scheint der standard GDB ein GDB-Multiarch zu sein.</p>
<h2><a class="anchor" id="autotoc_md4"></a>
Windows</h2>
<p>Installation von CMake über Download des Installers (<a href="https://cmake.org/download/">https://cmake.org/download/</a>) oder Paketmanager <code>winget install CMake.CMake</code>.</p>
<p>Installation der ARM GCC Toolchain <a href="https://gnutoolchains.com/arm-eabi/">Website</a> Nach z.B. C:\Toolchains\ <b>WICHTIG:</b> zu PATH hinzufügen (lassen)</p>
<h2><a class="anchor" id="autotoc_md5"></a>
Linux</h2>
<p>Über Paketmanager Installieren:</p>
<p><b>Ubuntu/ Debian</b>: <code>sudo apt install gcc-arm-none-eabi cmake</code></p>
<p><b>Arch</b>: </p><div class="fragment"><div class="line">yay -S gcc-arm-none-eabi-bin </div>
<div class="line">sudo pacman -S cmake</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md6"></a>
macOS</h2>
<div class="fragment"><div class="line">install gcc-arm-embedded cmake</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md7"></a>
Apple Silicon</h3>
<div class="fragment"><div class="line">install arm-none-eabi-gdb</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md8"></a>
Building</h1>
<p>Auschecken des Quellcodes: <code>git clone <a href="https://github.com/infohoschie/arm-cortex-m0-c-cmake.git">https://github.com/infohoschie/arm-cortex-m0-c-cmake.git</a></code></p>
<p>Erstellen des Build Mittels CMake Presets: </p><div class="fragment"><div class="line">--preset arm-cortex-m0-unix</div>
</div><!-- fragment --><p> oder </p><div class="fragment"><div class="line">--preset arm-cortex-m0-mingw</div>
</div><!-- fragment --><p>Bauen Mittels CMake Presets: </p><div class="fragment"><div class="line">--build --preset arm-cortex-m0-unix</div>
</div><!-- fragment --><p> oder </p><div class="fragment"><div class="line">--build --preset arm-cortex-m0-mingw</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md9"></a>
Generiertes Output analysieren (optional)</h1>
<ul>
<li>ELF-Sections anzeige: <code>arm-none-eabi-objdump -x build-cortex-m0/testApp.elf</code></li>
<li>ELF-File disassemblieren (mit Quellcode-Verknüpfung): <code>arm-none-eabi-objdump -d build-cortex-m0/testApp.elf</code> <code>arm-none-eabi-objdump -d -S build-cortex-m0/testApp.elf</code></li>
</ul>
<h1><a class="anchor" id="autotoc_md10"></a>
QEMU Emulator starten und mit GDB verbinden</h1>
<p>QEMU und GDB müssen in unterschiedlichen Konsolen (Shells) gestartet werden. </p>
<h2><a class="anchor" id="autotoc_md11"></a>
- QEMU Emulation Starten:</h2>
<p><code>qemu-system-arm -M microbit -device loader,file=build-cortex-m0/testApp.elf -nographic -S -s -serial mon:stdio</code> </p>
<h2><a class="anchor" id="autotoc_md12"></a>
- GDB zu QEMU verbinden:</h2>
<p><code>gdb-multiarch build-cortex-m0/testApp.elf -ex "target extended-remote localhost:1234" -ex "load"</code> </p>
<h3><a class="anchor" id="autotoc_md13"></a>
MacOS on Apple Silicon:</h3>
<p><code>arm-none-eabi-gdb build-cortex-m0/testApp.elf -ex "target extended-remote localhost:1234" -ex "load"</code></p>
<p>Um QEMU zu beenden die Tastenkombination <code>&lt;strg&gt; + a</code> und anschließend <code>x</code> nutzen.</p>
<h1><a class="anchor" id="autotoc_md14"></a>
IDEs</h1>
<h2><a class="anchor" id="autotoc_md15"></a>
Jetbrains CLion</h2>
<p>Das Projekt kann direkt in der IDE geöffnet (ausgecheckt) werden. Die CMake Presets werden direkt als build-target angeboten</p>
<p>Der integrierte Debugger kann direkt genutzt werden. Unter der Run-Configuration kann der QEMU Aufruf als "Native Application" hinzugefügt werden. Unter debug Configuration kann eine "Remote Debug" Konfiguration angelegt werden, bei der unter "target remote args" die Verbindungsdetails angeben und als <em>symbol file</em> die <em>testApp.elf</em> referenziert werden kann.</p>
<h2><a class="anchor" id="autotoc_md16"></a>
Visual Studio Code</h2>
<p>Folgende Extensions werden benötigt:</p><ul>
<li>jkearins.action-buttons-ext</li>
<li>webfreak.debug</li>
<li>maxmitti.cmake-tools-fork</li>
<li>twxs.cmake</li>
<li>dan-c-underwood.arm</li>
</ul>
<p>Diese sind ebenfalls als empfohlene Extensions im Workspace definiert.</p>
<p>Nach Installation erkennt VScode die CMake Presets und bietet diese gleich an. Ebenfalls wird in der Statusleiste ein Button <b>Start Qemu</b> hinzugefügt, über diesen die QEmu-Session (also unser Target) gestartet werden kann.</p>
<h3><a class="anchor" id="autotoc_md17"></a>
Wichtig:</h3>
<p>Zwischen der Extension <a href="https://marketplace.visualstudio.com/items?itemName=maxmitti.cmake-tools-fork">maxmitti.cmake-tools-fork</a> und <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.cmake-tools">ms-vscode.cmake-tools</a> kommt es zu Konflikten. Wichtig in diesem Projekt ist, dass der "Build"-Button in der Statusleiste nicht funktioniert, wenn beide Extensions installiert sind. Deswegen sollte die Extension <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.cmake-tools">ms-vscode.cmake-tools</a> deaktiviert werden. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
